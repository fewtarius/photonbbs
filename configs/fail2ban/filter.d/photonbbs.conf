# Fail2Ban filter for PhotonBBS
#
# Place this file in /etc/fail2ban/filter.d/photonbbs.conf
#
# This filter matches PhotonBBS log entries for failed login attempts

[Definition]

# Match failed password attempts logged by pb-usertools
# Example log: "photonbbs: WARN: username incorrect password on node 1 via 192.168.1.100"
failregex = ^.*photonbbs.*WARN:.*incorrect password.*via <HOST>$
            ^.*photonbbs.*SECURITY: Failed login from <HOST>
            ^.*photonbbs.*SECURITY: Auto-banned IP <HOST>

# Ignore successful logins
ignoreregex = ^.*photonbbs.*NOTICE:.*logged in

# Optional: Match connection attempts from banned IPs
# ^.*photonbbs.*ERROR.*Connection from banned IP <HOST>

[Init]
# Maximum time to keep log entries (1 day)
datepattern = ^%%Y-%%m-%%d %%H:%%M:%%S
