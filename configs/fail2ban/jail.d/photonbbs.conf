# Fail2Ban jail configuration for PhotonBBS
# 
# Place this file in /etc/fail2ban/jail.d/photonbbs.conf
#
# This jail monitors PhotonBBS logs for failed login attempts
# and automatically bans IPs that exceed the threshold.

[photonbbs]
enabled = true
port = 23
protocol = tcp
filter = photonbbs
logpath = /var/log/syslog
          /var/log/messages
# Maximum number of failed attempts before ban
maxretry = 5
# Time window to count retries (10 minutes)
findtime = 600
# Ban duration (1 hour)
bantime = 3600
# Action to take when ban threshold is reached
action = iptables-allports[name=PhotonBBS, protocol=tcp]
# Ignore localhost
ignoreip = 127.0.0.1/8 ::1

# Optional: Send email notifications on ban
# action = %(action_mwl)s

# Optional: Longer ban for repeat offenders
# bantime.increment = true
# bantime.factor = 2
# bantime.maxtime = 86400
